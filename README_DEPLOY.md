# Deployment Guide (Render)\n\n## 1. Prerequisites\n- GitHub repository pushed (branch: `farmer_db` or main).\n- Node.js 18+ recommended.\n- Render account (https://render.com).\n\n## 2. Decide: Static Hosting vs Full Server\nThis project is a Vite React SPA hitting an existing backend API at:\n`https://nabard-visitor-backend.onrender.com`\nSo you only need a Static Site on Render. No Node server required unless you add server logic.\n\n## 3. Environment Variable (Optional)\nIf you want flexibility for API base: create `.env` locally or in Render dashboard.\n````\nVITE_API_BASE_URL=https://nabard-visitor-backend.onrender.com\n````\nRender Static Sites exposes vars at build time. After changing env vars you must redeploy.\n\n## 4. Build Command & Publish Directory\n- Build Command: `npm install && npm run build`\n- Publish Directory: `dist`\n\nEnsure `package.json` has scripts:\n```json\n{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  }
}
```\n\n## 5. Steps in Render UI\n1. New + -> Static Site.\n2. Connect your GitHub repo.\n3. Select branch (recommend creating / using `main` for production).\n4. Name the service (e.g. `farmer-portal`).\n5. Set build command & publish dir.\n6. (Optional) Add env var: `VITE_API_BASE_URL`.\n7. Create Site -> first build starts.\n\n## 6. SPA Routing (Important)\nRender static hosting automatically supports client routing if an `index.html` is present. Vite outputs `index.html` to `dist`. No extra `_redirects` file required. If you see 404 on refresh for nested routes, enable SPA rewrite in Render (it usually auto-detects).\n\n## 7. Testing After Deploy\n- Open deployed URL.\n- Open DevTools Network tab.\n- Trigger a Visit Request; confirm POST goes to `/api/visit-request` on the backend domain and CORS succeeds.\n\n## 8. Common Issues\n| Issue | Cause | Fix |\n|-------|-------|-----|\n| CORS error | Backend not allowing origin | Add frontend domain to backend CORS allowlist |\n| 404 on refresh | SPA fallback missing | Ensure Render's Static Site uses index.html fallback |\n| Wrong API URL | Env var unset | Inspect built JS (search for `nabard-visitor`) or set `VITE_API_BASE_URL` |\n| Stale env var | Cached build | Trigger manual redeploy |\n\n## 9. Local Prod Preview\n```bash\nnpm run build\nnpm run preview\n```\nVisit `http://localhost:4173` (default) to mimic production bundle.\n\n## 10. Branch Strategy\n- `farmer_db` (feature / staging).\n- `main` (production).\nMerge via PR then Render auto-deploys `main`.\n\n## 11. Optional Hardening\n- Add a simple uptime monitor (e.g. Render health checks).\n- Implement retry/backoff in visit request (currently single attempt).\n- Add input validation for visit form before POST.\n\n## 12. Cache Busting\nVite already fingerprints assets (hash in filename). Browser updates automatically after each deploy.\n\n## 13. Rollbacks\nRender keeps previous build images; click a past deploy to roll back if needed.\n\n## 14. Future Enhancements\n- Add a serverless function proxy if backend domain changes often.\n- Introduce analytics or logging (respect privacy).\n- Add offline queue (workbox) for visit requests.\n\n---\nDeployment ready. Adjust `VITE_API_BASE_URL` if backend base path changes.\n
